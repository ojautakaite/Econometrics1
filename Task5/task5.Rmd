
---
title: "Task5"
author: "Orinta Jautakaitë, Simona Gritytë, Agnë Zavackaitë, Sandra Kazlovskaja"
output: html_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library('prob')
```

Tarkime, kad ridenami trys taisyklingi standartiniai loðimo kauliukai. Fiksuojama iðkritusiø akuèiø suma, paþymëkime ðá atsitiktiná dydá S.

1.Atlikite Monte-Carlo modeliavimà sugeneruodami S atsitiktinio dydþio nepriklausomas realizacijas S1, S2, ???, Sn. Èia n=10^5.
```{r}
n <- 10^5
S <- replicate(n, sum(sample(1:6, 3, replace = TRUE)))
head(S, 15)
```
Aukðèiau pateikta 15 pirmø atsitiktinio dydþio S realizacijø.

2.Raskite teoriná S skirstiná, t.y. kiekvienai galimai S reikðmei raskite pasirodymo tikimybæ.
```{r}
St <- rolldie (3, nsides = 6, makespace = TRUE)
St <- addrv(St, sum = X1 + X2 + X3)
S_teor <- marginal(St, vars="sum")
S_teor
```
Ðio kodo pavyzdá radome knygoje Kerns, G. Jay. 2011. ´Introduction to Probability and Statistics Using R.¡.

3.Ið sugeneruotos imties, padarykite santykiniø daþniø lentelæ ir gautas reikðmes palyginkite su teorinëmis tikimybëmis. Palyginimui pateikite grafikà ir lentelæ, taip, kad bûtø patogu lyginti gautus rezultatus.
```{r}
cbind(as.data.frame(table(S)/n), S_teor)
```

Teorinës tikimybës pateiktos deðinëje.
```{r}
plot(table(S)/n, xlab="Suma", ylab="Tikimybë")
points(S_teor, col=2)
```
Raudoni taðkai þymi teorines tikimybes.

4.Suskaièiuokite teoriná S vidurká ir dispersijà. Padarykite grafikus, kuriuose matytøsi, kaip didëjant n minëtø charakteristikø ávertiniai artëja á teorines reikðmes.

Teorinis vidurkis:
```{r}
ES <- sum(S_teor$probs * S_teor$sum)
ES
```
Teorinë dispersija:
```{r}
varS <- sum(S_teor$probs * (S_teor$sum-ES)^2)
varS
```

```{r}
plot(cumsum(S)/1:n, type="l", xlab="n", ylab = "S / n", main="Vidurkio artëjimas á teoriná")
abline(h=ES, col=2)

#suskaiciuojame kaip keitesi empirine dispersija didejant n
a = rep(0, n/10)
a = rep(0, n/10)
for(i in 1:10000){
  a[i]=var(S[1:(i*10)])
}

plot(((1:10000)*10), a, type="l", xlab="n", ylab="varS", main="Dispersijos artëjimas á teorinæ")
abline(h=varS, col=2)
```

